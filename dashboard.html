<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Adworth‚Ñ† ‚Äî Ad Intelligence Dashboard</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=DM+Serif+Display:ital@0;1&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --green-deep:    #1a4a35;
      --green-primary: #2d6a4f;
      --green-accent:  #52b788;
      --green-pale:    #d8f3dc;
      --green-tint:    #f0faf3;
      --off-white:     #fafaf8;
      --white:         #ffffff;
      --ink:           #111410;
      --ink-60:        #555a50;
      --ink-30:        #b0b5aa;
      --border:        #e2e8df;
      --red:           #e05252;
      --amber:         #d4930a;
      --mono:          'JetBrains Mono', monospace;
    }

    html { scroll-behavior: smooth; }

    body {
      font-family: 'Poppins', sans-serif;
      background: #0e1a14;
      color: var(--off-white);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* ‚îÄ‚îÄ GRID BACKGROUND ‚îÄ‚îÄ */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image:
        linear-gradient(rgba(82,183,136,0.04) 1px, transparent 1px),
        linear-gradient(90deg, rgba(82,183,136,0.04) 1px, transparent 1px);
      background-size: 40px 40px;
      pointer-events: none;
      z-index: 0;
    }

    /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
    header {
      position: sticky;
      top: 0;
      z-index: 100;
      background: rgba(14, 26, 20, 0.92);
      backdrop-filter: blur(16px);
      border-bottom: 1px solid rgba(82,183,136,0.15);
      padding: 0 2rem;
    }

    nav {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      height: 60px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      text-decoration: none;
    }

    .logo-text {
      font-size: 1.3rem;
      font-weight: 800;
      color: var(--green-accent);
      letter-spacing: -0.3px;
    }

    .badge {
      font-size: 0.6rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
      background: rgba(82,183,136,0.15);
      color: var(--green-accent);
      border: 1px solid rgba(82,183,136,0.3);
      padding: 0.2rem 0.5rem;
      border-radius: 100px;
    }

    .nav-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .status-dot {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.75rem;
      color: var(--green-accent);
      font-family: var(--mono);
    }

    .dot {
      width: 7px; height: 7px;
      background: var(--green-accent);
      border-radius: 50%;
      animation: pulse 2s infinite;
    }

    .dot.offline { background: var(--red); animation: none; }

    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.4; transform: scale(0.7); }
    }

    /* ‚îÄ‚îÄ MAIN LAYOUT ‚îÄ‚îÄ */
    .main {
      max-width: 1400px;
      margin: 0 auto;
      padding: 2rem;
      position: relative;
      z-index: 1;
    }

    /* ‚îÄ‚îÄ SEARCH BAR ‚îÄ‚îÄ */
    .search-section {
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(82,183,136,0.2);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
    }

    .search-label {
      font-size: 0.7rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 2px;
      color: var(--green-accent);
      margin-bottom: 1rem;
      display: block;
    }

    .search-row {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
    }

    .domain-input {
      flex: 1;
      min-width: 240px;
      padding: 0.85rem 1.25rem;
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(82,183,136,0.25);
      border-radius: 10px;
      color: var(--off-white);
      font-family: var(--mono);
      font-size: 0.95rem;
      transition: border-color 0.2s;
      outline: none;
    }

    .domain-input:focus {
      border-color: var(--green-accent);
      background: rgba(82,183,136,0.08);
    }

    .domain-input::placeholder { color: rgba(255,255,255,0.25); }

    .btn-analyze {
      padding: 0.85rem 1.75rem;
      background: var(--green-primary);
      color: white;
      border: none;
      border-radius: 10px;
      font-family: 'Poppins', sans-serif;
      font-weight: 700;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
    }

    .btn-analyze:hover { background: var(--green-accent); color: var(--ink); }
    .btn-analyze:disabled { opacity: 0.5; cursor: not-allowed; }

    .quick-domains {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      margin-top: 1rem;
    }

    .quick-chip {
      padding: 0.3rem 0.8rem;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 100px;
      font-size: 0.75rem;
      font-family: var(--mono);
      color: var(--ink-30);
      cursor: pointer;
      transition: all 0.2s;
    }

    .quick-chip:hover {
      border-color: var(--green-accent);
      color: var(--green-accent);
      background: rgba(82,183,136,0.08);
    }

    /* ‚îÄ‚îÄ METRICS ROW ‚îÄ‚îÄ */
    .metrics-row {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .metric-card {
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(82,183,136,0.12);
      border-radius: 12px;
      padding: 1.5rem;
      position: relative;
      overflow: hidden;
      transition: border-color 0.2s;
    }

    .metric-card:hover { border-color: rgba(82,183,136,0.3); }

    .metric-card::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--green-accent), transparent);
      opacity: 0.6;
    }

    .metric-label {
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      color: var(--ink-30);
      margin-bottom: 0.5rem;
    }

    .metric-value {
      font-family: 'DM Serif Display', serif;
      font-size: 2.25rem;
      color: var(--green-accent);
      line-height: 1;
      margin-bottom: 0.3rem;
    }

    .metric-sub {
      font-size: 0.75rem;
      color: var(--ink-60);
    }

    /* ‚îÄ‚îÄ CONTENT GRID ‚îÄ‚îÄ */
    .content-grid {
      display: grid;
      grid-template-columns: 1fr 380px;
      gap: 1.5rem;
    }

    /* ‚îÄ‚îÄ ANALYSIS PANEL ‚îÄ‚îÄ */
    .panel {
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(82,183,136,0.12);
      border-radius: 16px;
      overflow: hidden;
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1.25rem 1.5rem;
      border-bottom: 1px solid rgba(82,183,136,0.1);
    }

    .panel-title {
      font-size: 0.8rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      color: var(--green-accent);
    }

    .panel-body { padding: 1.5rem; }

    /* ‚îÄ‚îÄ SCORE RINGS ‚îÄ‚îÄ */
    .scores-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .score-card {
      background: rgba(0,0,0,0.2);
      border-radius: 12px;
      padding: 1.25rem;
      text-align: center;
    }

    .score-number {
      font-family: 'DM Serif Display', serif;
      font-size: 3rem;
      line-height: 1;
      margin-bottom: 0.3rem;
    }

    .score-label {
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--ink-30);
    }

    .score-risk    { color: var(--red); }
    .score-medium  { color: var(--amber); }
    .score-safe    { color: var(--green-accent); }

    /* ‚îÄ‚îÄ FINDINGS ‚îÄ‚îÄ */
    .finding-item {
      display: flex;
      gap: 0.75rem;
      padding: 0.9rem 0;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      align-items: flex-start;
    }

    .finding-item:last-child { border-bottom: none; }

    .finding-icon {
      width: 28px; height: 28px;
      min-width: 28px;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      margin-top: 1px;
    }

    .finding-icon.red   { background: rgba(224,82,82,0.15); }
    .finding-icon.amber { background: rgba(212,147,10,0.15); }
    .finding-icon.green { background: rgba(82,183,136,0.15); }

    .finding-text { font-size: 0.85rem; color: rgba(255,255,255,0.7); line-height: 1.5; }
    .finding-text strong { color: var(--off-white); font-weight: 600; display: block; margin-bottom: 0.1rem; }

    /* ‚îÄ‚îÄ AD LIST ‚îÄ‚îÄ */
    .ad-item {
      background: rgba(0,0,0,0.2);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 0.75rem;
      transition: border-color 0.2s;
    }

    .ad-item:hover { border-color: rgba(82,183,136,0.25); }

    .ad-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }

    .ad-domain {
      font-family: var(--mono);
      font-size: 0.75rem;
      color: var(--green-accent);
    }

    .ad-format {
      font-size: 0.65rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      background: rgba(82,183,136,0.1);
      color: var(--green-accent);
      border: 1px solid rgba(82,183,136,0.2);
      padding: 0.15rem 0.5rem;
      border-radius: 100px;
    }

    .ad-text {
      font-size: 0.85rem;
      color: rgba(255,255,255,0.6);
      line-height: 1.5;
      margin-bottom: 0.5rem;
    }

    .ad-footer {
      display: flex;
      gap: 0.75rem;
      font-size: 0.7rem;
      color: var(--ink-30);
      font-family: var(--mono);
      flex-wrap: wrap;
    }

    /* ‚îÄ‚îÄ SIDE PANEL ‚îÄ‚îÄ */
    .side-stack { display: flex; flex-direction: column; gap: 1.5rem; }

    .adworth-value {
      background: linear-gradient(135deg, rgba(45,106,79,0.3), rgba(82,183,136,0.1));
      border: 1px solid rgba(82,183,136,0.3);
      border-radius: 12px;
      padding: 1.25rem;
      font-size: 0.875rem;
      color: rgba(255,255,255,0.8);
      line-height: 1.6;
      font-style: italic;
    }

    .adworth-value strong {
      display: block;
      color: var(--green-accent);
      font-style: normal;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      margin-bottom: 0.5rem;
    }

    .tags-list {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      padding: 1rem 1.5rem 1.5rem;
    }

    .tag {
      padding: 0.3rem 0.7rem;
      border-radius: 100px;
      font-size: 0.72rem;
      font-weight: 500;
      border: 1px solid;
    }

    .tag-red   { background: rgba(224,82,82,0.1);   border-color: rgba(224,82,82,0.3);   color: #f09090; }
    .tag-amber { background: rgba(212,147,10,0.1);  border-color: rgba(212,147,10,0.3);  color: #e8b860; }
    .tag-green { background: rgba(82,183,136,0.1);  border-color: rgba(82,183,136,0.3);  color: var(--green-accent); }

    /* ‚îÄ‚îÄ DOMAIN HISTORY ‚îÄ‚îÄ */
    .history-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem 1.5rem;
      border-bottom: 1px solid rgba(255,255,255,0.04);
      cursor: pointer;
      transition: background 0.15s;
    }

    .history-item:hover { background: rgba(82,183,136,0.05); }

    .history-domain {
      font-family: var(--mono);
      font-size: 0.82rem;
      color: var(--off-white);
    }

    .history-score {
      font-size: 0.75rem;
      font-weight: 700;
      padding: 0.2rem 0.6rem;
      border-radius: 100px;
    }

    /* ‚îÄ‚îÄ LOADING STATE ‚îÄ‚îÄ */
    .loading-state {
      text-align: center;
      padding: 4rem 2rem;
      color: var(--ink-30);
    }

    .spinner {
      width: 40px; height: 40px;
      border: 3px solid rgba(82,183,136,0.1);
      border-top-color: var(--green-accent);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto 1.5rem;
    }

    @keyframes spin { to { transform: rotate(360deg); } }

    .loading-text {
      font-family: var(--mono);
      font-size: 0.85rem;
      color: var(--green-accent);
    }

    .loading-steps { margin-top: 1rem; }

    .loading-step {
      font-size: 0.75rem;
      color: var(--ink-30);
      padding: 0.25rem 0;
      opacity: 0;
      animation: fadeIn 0.4s forwards;
    }

    @keyframes fadeIn { to { opacity: 1; } }

    /* ‚îÄ‚îÄ EMPTY STATE ‚îÄ‚îÄ */
    .empty-state {
      text-align: center;
      padding: 5rem 2rem;
    }

    .empty-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
      opacity: 0.4;
    }

    .empty-title {
      font-family: 'DM Serif Display', serif;
      font-size: 1.5rem;
      color: var(--off-white);
      margin-bottom: 0.5rem;
      opacity: 0.6;
    }

    .empty-sub {
      font-size: 0.875rem;
      color: var(--ink-30);
    }

    /* ‚îÄ‚îÄ ERROR STATE ‚îÄ‚îÄ */
    .error-banner {
      background: rgba(224,82,82,0.1);
      border: 1px solid rgba(224,82,82,0.3);
      border-radius: 10px;
      padding: 1rem 1.25rem;
      font-size: 0.85rem;
      color: #f09090;
      margin-bottom: 1.5rem;
      display: none;
    }

    /* ‚îÄ‚îÄ INVESTOR NOTE ‚îÄ‚îÄ */
    .investor-strip {
      background: linear-gradient(90deg, rgba(45,106,79,0.2), rgba(82,183,136,0.1));
      border: 1px solid rgba(82,183,136,0.2);
      border-radius: 10px;
      padding: 1rem 1.5rem;
      margin-bottom: 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .investor-strip-text {
      font-size: 0.8rem;
      color: rgba(255,255,255,0.6);
    }

    .investor-strip-text strong { color: var(--green-accent); }

    .live-pill {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.7rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--green-accent);
      background: rgba(82,183,136,0.1);
      border: 1px solid rgba(82,183,136,0.25);
      padding: 0.3rem 0.75rem;
      border-radius: 100px;
    }

    /* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
    footer {
      text-align: center;
      padding: 3rem 2rem 2rem;
      font-size: 0.75rem;
      color: var(--ink-30);
      position: relative;
      z-index: 1;
    }

    footer a { color: var(--ink-30); text-decoration: none; }
    footer a:hover { color: var(--green-accent); }

    /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
    @media (max-width: 1024px) {
      .content-grid { grid-template-columns: 1fr; }
      .metrics-row { grid-template-columns: repeat(2, 1fr); }
    }

    @media (max-width: 600px) {
      .metrics-row { grid-template-columns: repeat(2, 1fr); }
      .scores-row { grid-template-columns: 1fr; }
      .main { padding: 1rem; }
    }
  </style>
</head>
<body>

  <header>
    <nav>
      <a href="/" class="logo">
        <span class="logo-text">Adworth‚Ñ†</span>
        <span class="badge">Ad Intelligence</span>
      </a>
      <div class="nav-right">
        <div class="status-dot" id="api-status">
          <span class="dot" id="status-dot"></span>
          <span id="status-text">Connecting‚Ä¶</span>
        </div>
      </div>
    </nav>
  </header>

  <div class="main">

    <!-- Investor context strip -->
    <div class="investor-strip">
      <div class="investor-strip-text">
        <strong>Live Demo</strong> ‚Äî Real ad transparency data powered by patent-pending consent infrastructure.
        Seed round open ¬∑ $1.5M ¬∑ <a href="/enterprise.html" style="color:var(--green-accent)">Investor Overview ‚Üí</a>
      </div>
      <div class="live-pill"><span class="dot"></span> Live Data</div>
    </div>

    <!-- Search -->
    <div class="search-section">
      <span class="search-label">Analyze Advertiser Transparency</span>
      <div class="search-row">
        <input
          class="domain-input"
          id="domain-input"
          type="text"
          placeholder="Enter domain e.g. nike.com"
          autocomplete="off"
          spellcheck="false"
        >
        <button class="btn-analyze" id="analyze-btn" onclick="analyzeDomain()">
          Analyze ‚Üí
        </button>
      </div>
      <div class="quick-domains">
        <span class="search-label" style="margin:0; align-self:center;">Quick:</span>
        <span class="quick-chip" onclick="quickSearch('apple.com')">apple.com</span>
        <span class="quick-chip" onclick="quickSearch('amazon.com')">amazon.com</span>
        <span class="quick-chip" onclick="quickSearch('spotify.com')">spotify.com</span>
        <span class="quick-chip" onclick="quickSearch('meta.com')">meta.com</span>
        <span class="quick-chip" onclick="quickSearch('target.com')">target.com</span>
      </div>
    </div>

    <!-- Error banner -->
    <div class="error-banner" id="error-banner"></div>

    <!-- Metrics row -->
    <div class="metrics-row" id="metrics-row" style="display:none;">
      <div class="metric-card">
        <div class="metric-label">Ads Found</div>
        <div class="metric-value" id="m-ads">‚Äî</div>
        <div class="metric-sub">from transparency center</div>
      </div>
      <div class="metric-card">
        <div class="metric-label">Privacy Risk</div>
        <div class="metric-value" id="m-risk" style="color:var(--red)">‚Äî</div>
        <div class="metric-sub">AI-scored 1‚Äì10</div>
      </div>
      <div class="metric-card">
        <div class="metric-label">Transparency Score</div>
        <div class="metric-value" id="m-trans" style="color:var(--amber)">‚Äî</div>
        <div class="metric-sub">disclosure quality</div>
      </div>
      <div class="metric-card">
        <div class="metric-label">Regulatory Flags</div>
        <div class="metric-value" id="m-flags" style="color:var(--amber)">‚Äî</div>
        <div class="metric-sub">GDPR / CCPA / DSA</div>
      </div>
    </div>

    <!-- Main content -->
    <div class="content-grid">

      <!-- Left: Analysis + Ads -->
      <div>
        <div class="panel" id="main-panel">
          <div class="panel-header">
            <span class="panel-title" id="panel-title">Ad Transparency Analysis</span>
            <span style="font-size:0.75rem; color:var(--ink-30); font-family:var(--mono);" id="panel-domain"></span>
          </div>
          <div class="panel-body" id="panel-body">
            <div class="empty-state">
              <div class="empty-icon">üîç</div>
              <div class="empty-title">Enter a domain to begin</div>
              <div class="empty-sub">Adworth will pull real ads and run AI privacy analysis</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right: Sidebar -->
      <div class="side-stack">

        <!-- AI Finding -->
        <div class="panel" id="finding-panel" style="display:none;">
          <div class="panel-header">
            <span class="panel-title">Adworth AI Finding</span>
          </div>
          <div class="panel-body">
            <div class="adworth-value" id="adworth-value">
              <strong>Why Adworth Matters Here</strong>
              <span id="adworth-value-text"></span>
            </div>
            <div style="margin-top:1rem; font-size:0.8rem; color:var(--ink-30); line-height:1.6;" id="top-finding"></div>
          </div>
        </div>

        <!-- Data Types -->
        <div class="panel" id="tags-panel" style="display:none;">
          <div class="panel-header">
            <span class="panel-title">Data Types Inferred</span>
          </div>
          <div class="tags-list" id="tags-list"></div>
        </div>

        <!-- Regulatory Flags -->
        <div class="panel" id="reg-panel" style="display:none;">
          <div class="panel-header">
            <span class="panel-title">Regulatory Flags</span>
          </div>
          <div class="panel-body" id="reg-body"></div>
        </div>

        <!-- Domain History -->
        <div class="panel" id="history-panel">
          <div class="panel-header">
            <span class="panel-title">Recently Analyzed</span>
          </div>
          <div id="history-list">
            <div style="padding:1.5rem; text-align:center; color:var(--ink-30); font-size:0.8rem;">
              Analyzed domains will appear here
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <footer>
    <p>¬© 2026 Adworth‚Ñ† LLC ¬∑ Patent Pending ¬∑ Charleston, SC</p>
    <p style="margin-top:0.3rem;">
      <a href="/privacy.html">Privacy Policy</a> ¬∑
      <a href="/terms.html">Terms of Service</a> ¬∑
      <a href="/">‚Üê Back to Home</a>
    </p>
    <p style="margin-top:1rem; padding-top:1rem; border-top:1px solid rgba(255,255,255,0.06); font-size:0.72rem; color:rgba(255,255,255,0.25); line-height:1.7; max-width:760px; margin-left:auto; margin-right:auto;">
      <strong style="color:rgba(255,255,255,0.35); font-weight:600;">Disclosure:</strong>
      This tool retrieves publicly available ad data from Google's Ads Transparency Center via SerpApi and displays a maximum of 40 results per query for performance and clarity. Results may not represent the complete advertising activity of any domain.
      All privacy risk scores, transparency scores, regulatory flags, and AI-generated findings are produced by Anthropic's Claude AI for informational and educational purposes only.
      This analysis does not constitute legal advice, a compliance determination, or a finding of wrongdoing by any advertiser, company, or platform.
      No inference of illegal activity, regulatory violation, or improper conduct should be drawn from any score, flag, or finding displayed here.
      Adworth‚Ñ† LLC makes no representations regarding the accuracy or completeness of third-party ad data.
    </p>
  </footer>

  <script>
    // ‚îÄ‚îÄ CONFIG ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // Replace with your deployed Worker URL after deployment
    const WORKER_URL = 'https://adworth-ads.adworthllc.workers.dev';

    const domainHistory = [];

    // ‚îÄ‚îÄ HEALTH CHECK ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function checkHealth() {
      try {
        const res = await fetch(`${WORKER_URL}/health`);
        if (res.ok) {
          document.getElementById('status-dot').className = 'dot';
          document.getElementById('status-text').textContent = 'API Live';
        } else throw new Error();
      } catch {
        document.getElementById('status-dot').className = 'dot offline';
        document.getElementById('status-text').textContent = 'API Offline';
      }
    }

    // ‚îÄ‚îÄ QUICK SEARCH ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function quickSearch(domain) {
      document.getElementById('domain-input').value = domain;
      analyzeDomain();
    }

    // ‚îÄ‚îÄ MAIN ANALYZE FUNCTION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function analyzeDomain() {
      const input = document.getElementById('domain-input');
      const domain = input.value.trim().replace(/^https?:\/\//, '').replace(/\/$/, '');
      if (!domain) return;

      const btn = document.getElementById('analyze-btn');
      btn.disabled = true;
      btn.textContent = 'Analyzing‚Ä¶';

      hideError();
      showLoading(domain);
      hideMetrics();
      hideSidePanels();

      try {
        const res = await fetch(`${WORKER_URL}/ads?domain=${encodeURIComponent(domain)}`);
        const data = await res.json();

        if (!res.ok) throw new Error(data.error || 'Worker error');

        renderResults(data);
        addToHistory(domain, data.analysis?.privacyRiskScore);

      } catch (err) {
        showError(`Could not analyze ${domain}: ${err.message}. Make sure the Worker is deployed.`);
        showEmptyState();
      } finally {
        btn.disabled = false;
        btn.textContent = 'Analyze ‚Üí';
      }
    }

    // ‚îÄ‚îÄ RENDER RESULTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function renderResults(data) {
      const { domain, adCount, ads, analysis } = data;

      // Metrics
      document.getElementById('m-ads').textContent = adCount || 0;

      const risk = analysis?.privacyRiskScore;
      const trans = analysis?.transparencyScore;
      const flags = analysis?.regulatoryFlags?.length || 0;

      const riskEl = document.getElementById('m-risk');
      riskEl.textContent = risk ?? '‚Äî';
      riskEl.style.color = risk >= 7 ? 'var(--red)' : risk >= 4 ? 'var(--amber)' : 'var(--green-accent)';

      const transEl = document.getElementById('m-trans');
      transEl.textContent = trans ?? '‚Äî';
      transEl.style.color = trans >= 7 ? 'var(--green-accent)' : trans >= 4 ? 'var(--amber)' : 'var(--red)';

      document.getElementById('m-flags').textContent = flags;
      showMetrics();

      // Panel header
      document.getElementById('panel-domain').textContent = domain;
      document.getElementById('panel-title').textContent = `Ads Found (${adCount})`;

      // Score cards + findings
      let html = '';

      if (analysis) {
        html += `
          <div class="scores-row">
            <div class="score-card">
              <div class="score-number ${scoreColor(risk, true)}">${risk ?? '‚Äî'}</div>
              <div class="score-label">Privacy Risk</div>
            </div>
            <div class="score-card">
              <div class="score-number ${scoreColor(trans, false)}">${trans ?? '‚Äî'}</div>
              <div class="score-label">Transparency</div>
            </div>
          </div>`;

        if (analysis.consentGaps?.length) {
          html += '<div>';
          analysis.consentGaps.slice(0, 4).forEach(gap => {
            html += `
              <div class="finding-item">
                <div class="finding-icon red">‚ö†</div>
                <div class="finding-text"><strong>Consent Gap</strong>${gap}</div>
              </div>`;
          });
          html += '</div>';
        }
      }

      // Ad list
      if (ads?.length) {
        html += `<div style="margin-top:1.5rem; font-size:0.7rem; font-weight:700; text-transform:uppercase; letter-spacing:1.5px; color:var(--ink-30); margin-bottom:0.75rem;">Active Ads</div>`;
        ads.slice(0, 15).forEach(ad => {
          html += `
            <div class="ad-item">
              <div class="ad-meta">
                <span class="ad-domain">${ad.advertiser || domain}</span>
                <span class="ad-format">${ad.format || 'ad'}</span>
              </div>
              ${ad.text ? `<div class="ad-text">${ad.text.slice(0, 140)}${ad.text.length > 140 ? '‚Ä¶' : ''}</div>` : ''}
              <div class="ad-footer">
                ${ad.platforms?.length ? `<span>üì± ${ad.platforms.slice(0,2).join(', ')}</span>` : ''}
                ${ad.lastShown ? `<span>Last seen: ${ad.lastShown}</span>` : ''}
                ${ad.regions?.length ? `<span>üåç ${ad.regions.slice(0,2).join(', ')}</span>` : ''}
              </div>
            </div>`;
        });
      } else {
        html += `<div style="padding:2rem; text-align:center; color:var(--ink-30); font-size:0.85rem;">No ads returned for this domain. Try a major brand like apple.com or amazon.com.</div>`;
      }

      document.getElementById('panel-body').innerHTML = html;

      // Side panels
      if (analysis) {
        // AI finding
        document.getElementById('adworth-value-text').textContent = analysis.adworthValue || '';
        document.getElementById('top-finding').textContent = analysis.topFinding || '';
        document.getElementById('finding-panel').style.display = 'block';

        // Data types
        if (analysis.dataTypesInferred?.length) {
          const tagsHtml = analysis.dataTypesInferred.map(t =>
            `<span class="tag tag-amber">${t}</span>`
          ).join('');
          document.getElementById('tags-list').innerHTML = tagsHtml;
          document.getElementById('tags-panel').style.display = 'block';
        }

        // Regulatory flags
        if (analysis.regulatoryFlags?.length) {
          const regHtml = analysis.regulatoryFlags.map(f => `
            <div class="finding-item">
              <div class="finding-icon red">‚öñ</div>
              <div class="finding-text">${f}</div>
            </div>`).join('');
          document.getElementById('reg-body').innerHTML = regHtml;
          document.getElementById('reg-panel').style.display = 'block';
        }
      }
    }

    // ‚îÄ‚îÄ HISTORY ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function addToHistory(domain, riskScore) {
      if (!domainHistory.find(d => d.domain === domain)) {
        domainHistory.unshift({ domain, riskScore });
        if (domainHistory.length > 8) domainHistory.pop();
      }
      renderHistory();
    }

    function renderHistory() {
      if (!domainHistory.length) return;
      const html = domainHistory.map(item => `
        <div class="history-item" onclick="quickSearch('${item.domain}')">
          <span class="history-domain">${item.domain}</span>
          ${item.riskScore != null ? `
            <span class="history-score" style="background:${item.riskScore >= 7 ? 'rgba(224,82,82,0.15)' : 'rgba(82,183,136,0.15)'}; color:${item.riskScore >= 7 ? '#f09090' : 'var(--green-accent)'}">
              Risk ${item.riskScore}/10
            </span>` : ''}
        </div>`).join('');
      document.getElementById('history-list').innerHTML = html;
    }

    // ‚îÄ‚îÄ HELPERS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function scoreColor(score, invertHigh) {
      if (!score) return '';
      if (invertHigh) return score >= 7 ? 'score-risk' : score >= 4 ? 'score-medium' : 'score-safe';
      return score >= 7 ? 'score-safe' : score >= 4 ? 'score-medium' : 'score-risk';
    }

    function showLoading(domain) {
      document.getElementById('panel-body').innerHTML = `
        <div class="loading-state">
          <div class="spinner"></div>
          <div class="loading-text">Analyzing ${domain}</div>
          <div class="loading-steps">
            <div class="loading-step" style="animation-delay:0.3s">‚Üí Pulling ads from Google Transparency Center</div>
            <div class="loading-step" style="animation-delay:1.2s">‚Üí Running AI privacy analysis</div>
            <div class="loading-step" style="animation-delay:2.2s">‚Üí Scoring consent gaps &amp; regulatory flags</div>
          </div>
        </div>`;
    }

    function showEmptyState() {
      document.getElementById('panel-body').innerHTML = `
        <div class="empty-state">
          <div class="empty-icon">‚ö†Ô∏è</div>
          <div class="empty-title">Analysis Failed</div>
          <div class="empty-sub">Check that your Worker is deployed and secrets are set</div>
        </div>`;
    }

    function showMetrics()  { document.getElementById('metrics-row').style.display = 'grid'; }
    function hideMetrics()  { document.getElementById('metrics-row').style.display = 'none'; }
    function showError(msg) { const el = document.getElementById('error-banner'); el.textContent = msg; el.style.display = 'block'; }
    function hideError()    { document.getElementById('error-banner').style.display = 'none'; }

    function hideSidePanels() {
      ['finding-panel', 'tags-panel', 'reg-panel'].forEach(id => {
        document.getElementById(id).style.display = 'none'      });
    }

    // ‚îÄ‚îÄ ENTER KEY ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    document.getElementById('domain-input').addEventListener('keydown', function(e) {
      if (e.key === 'Enter') analyzeDomain();
    });

    // ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    checkHealth();
  </script>

</body>
</html>
